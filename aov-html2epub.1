.Dd April 14, 2021
.Os Unix
.Dt aov-html2epub 1 URM
.Sh NAME
.Nm aov-html2epub
.Nd Takes a list of HTML5 files and turns them into an EPUB, version 3, with back-compatibility for v2.
.Sh SYNOPSIS
.Nm
.Ar EPUB_FILE
.Fl t Ar title
.Op Fl a Ar name Ns Op Ar |filebyname
.Op Fl d Ar date
.Op Fl s Ar subject
.Op Fl p Ar maker
.Op Fl P Ar publisher
.Op Fl T Ar translator
.Op Fl c Ar cover.img
.Op Fl l Ar lang
.Op Fl L Ar license
.Op Fl u Ar uuid
.Op Fl D Ar subdir
.Op Fl -debug
.Ar
.Sh DESCRIPTION
.Nm
zips
.Pa *.html
and other files into an EPUB with a correct
.Pa mimetype
file
.Pq stored, not deflated .
The only
.Em requirements
to build an EPUB are: the EPUB name, a title, and one or more HTML5 files.
The order of command line options is generally unimportant
.Em except
to HTML files and the
.Fl a Ar author
arguments, see below.
.Pp
Tables of contents
.Pq TOCs
for EPUB2 and 3 are generated for the HTML files.
Nested TOCs are supported.
All HTML files will be added to the EPUB reading order
.Em exactly as given on the command line .
.Pp
Font
.Po
.Pa *.ttf
and
.Pa *.woff
.Pc ,
CSS, and image files may be included by listing them on the command line;
.Nm
will catalog them properly in the OPF file manifest.
.Pp
Subject, author, and title may be specified more than once.
.Pp
.Nm
generates these files, which are all deleted after the EPUB is built:
.Bd -ragged -offset indent
.Bl -column
.It Pa mimetype Ta Pa META-INF/container.xml
.It Pa toc.ncx Ta Pa content.opf
.It Pa toc.xhtml Ta Pa titlepage.xhtml
.El
.Ed
.Pp
A customized yet basic title page will be generated unless you provide one in the build directory.
If a cover image is provided, it will be the only element visible on the title page.
If the file
.Pa description
exists
.Pq which should contain one or more lines of UTF-8 text, and no HTML ,
it will be added to the OPF file’s “dc:description” section.
.Pp
.Xr file 1
is used to identify the MIME types of non-HTML files.
.Xr zip 1
is used to generate the EPUB.
If
.Fl u
is not specified,
.Xr uuidgen 1
will be used to generate a random UUID, if present.
For consistency, randomly generate a single UUID for each book and specify it each time you build.
.Pp
The EPUB standard allows the OPF file
.Pq and every other file
to be in the base directory of the ZIP file, along with
.Pa mimetype
and
.Pa META-INF/ .
But it is cleaner and more correct to place these files in a subdirectory, canonically
.Pa OPS
or
.Pa OEBPS .
Specifying a sub-directory like
.Fl D Ar OPS
builds the generated files in that subdir, and sets the correct relative filepaths in the OPF and TOC files.
.Pp
No ungenerated files should be moved, modified, or deleted by this program.
.Sh OPTIONS
.Bl -tag
.It Fl t Ar title
Book title, one
.Pq or more
is
.Em required .
.It Fl a Ar name Ns Op Ar |filebyname
Author name and (optional) file-by name, separated with a pipe character
.Pq Qq First Last|Last, First ,
with one
.Fl a
per author.
Command line order of options is important only for multiple authors
.Pq and HTML files ,
since the first
.Fl a
listed is usually considered the primary author by EPUB readers.
.It Fl d Ar date
Publishing date (ISO 8601), e.g. July 1999 is
.Qq 1999-07 .
.It Fl s Ar subject
Subject(s), zero or more, one
.Fl s
per subject.
.It Fl p Ar maker
EPUB creator
.It Fl P Ar publisher
Publishing house
.It Fl T Ar translator
Translator
.It Fl c Ar cover.img
Cover image
.It Fl l Ar lang
Language
.Po BCP 47, default
.Qq en-US
.Pc
.It Fl L Ar license
Content copyright or license, default
.Qq CC BY-SA 4.0
.It Fl u Ar uuid
Universal Unique ID
.It Fl D Ar subdir
Build subdirectory
.Pq OPS or OEBPS
.It Fl -debug
Do not delete generated files
.El
.Sh EXAMPLES
The simplest example:
.Dl aov-html2epub Ross,_Bob.Happy_Trees.epub -t \&"Happy Trees\&" part1.html part2.html part3.html
.Pp
A more complex example:
.Dl aov-html2epub Ross,_Bob.Happy_Trees.epub -t \&"Happy Trees\&" -a \&"Bob Ross|Ross, Bob\&" \
-d 2001-12 -s Painting -s Trees -c treecover.jpg -u c5be00f9-932e-4903-8cd9-b4b5939411a6 \
-P \&"Happy Tree Publishing House\&" part1.html part2.html part3.html treesnewroman.ttf default.css
.Pp
A simple example using the
.Pa OEBPS
subdirectory. Note: with
.Fl D Ar OEBPS
set, this app will expect the cover image at
.Pa OEBPS/treecover.jpg :
.Dl aov-html2epub Ross,_Bob.Happy_Trees.epub -t \&"Happy Trees\&" -D OEBPS -c treecover.jpg \
OEBPS/part1.html OEBPS/part2.html OEBPS/part3.html OEBPS/default.css
.Pp
.Xr make 1
is an excellent tool for building and updating EPUBs with this script, but, depending on how you
provide the HTML file names to make, you may want to
.Ic $(sort)
the file names to keep the files in order.
.Sh SEE ALSO
.Xr epubcheck 1 , Xr zip 1 , Xr uuidgen 1 , Xr file 1 .
.Pp
.Lk https://tools.ietf.org/html/bcp47 IETF BCP 47, “Tags for Identifying Languages”
.Pp
.Lk https://tools.ietf.org/html/rfc3339 IETF RFC 3339, “Date and Time on the Internet,” based on ISO 8601
.Sh LICENSE
“Released under the public domain. Use as you want, specially for evil.”
This program is publicly available at
.Lk https://github.com/somercet/aov-html2epub Github
.Sh AUTHORS
.An somercet
.An Angel Ortega Aq Mt angel@triptico.com
